### Метрики в задаче ранжирования  
num_swapped_pairs — функция для расчёта количества неправильно упорядоченных пар (корректное упорядочивание — от наибольшего значения в ys_true к наименьшему) или переставленных пар. Не забудьте, что одну и ту же пару не нужно учитывать дважды. 

compute_gain — вспомогательная функция для расчёта DCG и NDCG, рассчитывающая показатель Gain. Принимает на вход дополнительный аргумент — указание схемы начисления Gain (gain_scheme).

В лекции был приведён пример константного начисления, равного в точности оценке релевантности. Необходимо реализовать как этот метод (при gain_scheme="const") начисления Gain, так и экспоненциальный (gain_scheme="exp2"), рассчитываемый по формуле (2 
r
 −1), где r — реальная релевантность документа некоторому запросу. Логика здесь такова, что чем выше релевантность, тем ценнее объект, и темп роста “ценности" нелинейный — гораздо важнее отделить документ с релевантностью 5 от документа с релевантностью 3, нежели 3 от 1 (ведь они оба слабо релевантны).

Функция принимает на вход единственное число (не тензор).

dcg и ndcg — функции расчёта DCG и NDCG соответственно. Принимают на вход дополнительный параметр gain_scheme, аналогичный таковому в функции compute_gain (её необходимо использовать при расчётах этих метрик). Для NDCG разрешается переиспользовать функцию расчёта DCG.

precission_at_k — функция расчёта точности в топ-k позиций для бинарной разметки (в ys_true содержатся только нули и единицы). Если среди лейблов нет ни одного релевантного документа (единицы), то необходимо вернуть -1. Функция принимает на вход параметр k, указывающий на то, по какому количеству объектов необходимо произвести расчёт метрики. Учтите, что k может быть больше количества элементов во входных тензорах. При реализации precission_at_k необходимо добиться того, что максимум функции в единице был достижим при любом ys_true, за исключением не содержащего единиц (попробуйте рассмотреть проблему на примере ранжирования поисковой выдачи, где в разметке присутствует n<k релевантных документов). В силу этой особенности не рекомендуется переиспользовать имплементацию precission_at_k в других метриках настоящего ДЗ. Можете также считать, что в ys_true содержатся все возможные единицы в датасете (например, если система отбора кандидатов для ранжирования их пропустила, то можно добавить такой объект c предсказанным значением −∞).

reciprocal_rank — функция для расчёта MRR (без усреднения, т.е. для одного запроса и множества документов). В ys_true могут содержаться только нули и максимум одна единица. 

p_found — функция расчёта P-found от Яндекса, принимающая на вход дополнительный параметр p_break — вероятность прекращения просмотра списка документов в выдаче. Базовая вероятность просмотреть первый документ в выдаче (pLook[0] в лекции) равняется единице. ys_true нормированы от 0 до 1 (вероятность удовлетворения запроса пользователя).

average_precision — функция расчёта AP для бинарной разметки (в ys_true содержатся только нули и единицы). Если среди лейблов нет ни одного релевантного документа (единицы), то необходимо вернуть -1.
